{"eventType":"CREATE_TABLE","eventTime":"2023-10-05T12:00:00Z","job":{"namespace":"example_namespace","name":"customer_order_summary_creation","version":"1.0"},"runId":"run-123456","inputs":[{"namespace":"example_namespace","name":"customers","version":"1.0","schema":"customers_schema"},{"namespace":"example_namespace","name":"orders","version":"1.0","schema":"orders_schema"},{"namespace":"example_namespace","name":"order_items","version":"1.0","schema":"order_items_schema"},{"namespace":"example_namespace","name":"products","version":"1.0","schema":"products_schema"}],"outputs":[{"namespace":"example_namespace","name":"customer_order_summary","version":"1.0","schema":"customer_order_summary_schema"}],"operations":[{"input":{"table":"customers","fields":[{"name":"customer_id","source":"customers.customer_id","transformation":"Direct reference"},{"name":"customer_name","source":"customers.name","transformation":"Direct reference, aliased as customer_name"},{"name":"country","source":"customers.country","transformation":"Direct reference"}]},"joins":[{"table":"orders","on":"c.customer_id = o.customer_id"},{"table":"order_items","on":"o.order_id = oi.order_id"},{"table":"products","on":"oi.product_id = p.product_id"}],"filters":[{"field":"customers.country","condition":"='USA'"}],"groupBy":["c.customer_id","c.name","c.country"],"aggregations":{"total_orders":{"source":"orders.order_id","transformation":"COUNT(DISTINCT orders.order_id)"},"total_quantity":{"source":"order_items.quantity","transformation":"SUM(order_items.quantity)"},"total_spent":{"source":"order_items.quantity, products.price","transformation":"SUM(order_items.quantity * products.price)"},"last_order_date":{"source":"orders.order_date","transformation":"MAX(orders.order_date)"}}}]}
{"eventType":"START","eventTime":"2023-10-11T10:00:00Z","run":{"runId":"example-run-id"},"job":{"namespace":"example-namespace","name":"create_customer_order_summary"},"inputs":[{"namespace":"example-database","name":"customers","facets":{}},{"namespace":"example-database","name":"orders","facets":{}},{"namespace":"example-database","name":"order_items","facets":{}},{"namespace":"example-database","name":"products","facets":{}}],"outputs":[{"namespace":"example-database","name":"customer_order_summary","facets":{}}],"facets":{"sql.facets":{"query":"CREATE TABLE customer_order_summary AS\nSELECT\n    c.customer_id,\n    c.name AS customer_name,\n    c.country,\n    COUNT(DISTINCT o.order_id) AS total_orders,\n    SUM(oi.quantity) AS total_quantity,\n    SUM(oi.quantity * p.price) AS total_spent,\n    MAX(o.order_date) AS last_order_date\nFROM\n    customers c\nJOIN\n    orders o ON c.customer_id = o.customer_id\nJOIN\n    order_items oi ON o.order_id = oi.order_id\nJOIN\n    products p ON oi.product_id = p.product_id\nWHERE\n    c.country = 'USA'\nGROUP BY\n    c.customer_id, c.name, c.country;"},"dataQualityMetrics":{},"processingMetadata":{"gracePeriod":"P0D"}},"producers":[{"integer":1,"logicalUnit":"https://example.com"}]}
{"eventType":"CREATE_TABLE","eventTime":"2023-10-04T10:00:00Z","runId":"run-1234","producer":"lineage-generator","jobName":"Create Customer Order Summary","namespace":"customer_ordering","inputDataset":[{"name":"customers","namespace":"customer_data","version":"1.0","fields":["customer_id","name","country"]},{"name":"orders","namespace":"order_data","version":"1.0","fields":["customer_id","order_id","order_date"]},{"name":"order_items","namespace":"order_data","version":"1.0","fields":["order_id","product_id","quantity"]},{"name":"products","namespace":"product_data","version":"1.0","fields":["product_id","price"]}],"outputDataset":{"name":"customer_order_summary","namespace":"customer_ordering","version":"1.0","fields":[{"name":"customer_id","source":"customers.customer_id","transformation":"Direct reference"},{"name":"customer_name","source":"customers.name","transformation":"Direct reference with alias"},{"name":"country","source":"customers.country","transformation":"Direct reference"},{"name":"total_orders","source":"orders.order_id","transformation":"COUNT(DISTINCT order_id)"},{"name":"total_quantity","source":"order_items.quantity","transformation":"SUM(quantity)"},{"name":"total_spent","source":"order_items.quantity, products.price","transformation":"SUM(quantity * price)"},{"name":"last_order_date","source":"orders.order_date","transformation":"MAX(order_date)"}]},"lineage":{"operations":[{"source_table":"customers","source_fields":["customer_id","name","country"],"logical_operators":{"filters":["c.country = 'USA'"],"joins":[],"group_by":["c.customer_id","c.name","c.country"]}},{"source_table":"orders","source_fields":["customer_id","order_date"],"logical_operators":{"filters":[],"joins":["c.customer_id = o.customer_id"],"group_by":[]}},{"source_table":"order_items","source_fields":["order_id","quantity","product_id"],"logical_operators":{"filters":[],"joins":["o.order_id = oi.order_id"],"group_by":[]}},{"source_table":"products","source_fields":["price","product_id"],"logical_operators":{"filters":[],"joins":["oi.product_id = p.product_id"],"group_by":[]}}]}}
".\n3. **Logical Operations**: Encapsulates each source table's fields and outlines:\n   - **Filters**: Conditions applied to the datasets.\n   - **Joins**: Relationships established between tables for data extraction.\n   - **Group By**: Specifies how data is aggregated.\n\n### Summary\nThis JSON representation captures all essential information about how the `customer_order_summary` table is created from the underlying `customers`, `orders`, `order_items`, and `products` tables, including specific fields, transformations, and logical operations without inferring additional context."
"Here is a structured JSON representation encompassing the complete lineage of the SQL query you provided, integrating the structure, field mapping, and operation logic:\n\n{\n  \"lineage\": {\n    \"structure\": {\n      \"operation\": \"CREATE TABLE\",\n      \"target_table\": \"customer_order_summary\",\n      \"select\": [\n        \"c.customer_id\",\n        \"c.name AS customer_name\",\n        \"c.country\",\n        \"COUNT(DISTINCT o.order_id) AS total_orders\",\n        \"SUM(oi.quantity) AS total_quantity\",\n        \"SUM(oi.quantity * p.price) AS total_spent\",\n        \"MAX(o.order_date) AS last_order_date\"\n      ],\n      \"from\": {\n        \"base_table\": \"customers c\",\n        \"joins\": [\n          {\n            \"table\": \"orders o\",\n            \"on\": \"c.customer_id = o.customer_id\"\n          },\n          {\n            \"table\": \"order_items oi\",\n            \"on\": \"o.order_id = oi.order_id\"\n          },\n          {\n            \"table\": \"products p\",\n            \"on\": \"oi.product_id = p.product_id\"\n          }\n        ]\n      },\n      \"where\": \"c.country = 'USA'\",\n      \"group_by\": [\n        \"c.customer_id\",\n        \"c.name\",\n        \"c.country\"\n      ]\n    },\n    \"field_mapping\": {\n      \"output_fields\": [\n        {\n          \"name\": \"customer_id\",\n          \"source\": \"customers.customer_id\",\n          \"transformation\": \"Direct copy\"\n        },\n        {\n          \"name\": \"customer_name\",\n          \"source\": \"customers.name\",\n          \"transformation\": \"Direct copy with alias\"\n        },\n        {\n          \"name\": \"country\",\n          \"source\": \"customers.country\",\n          \"transformation\": \"Direct copy\"\n        },\n        {\n          \"name\": \"total_orders\",\n          \"source\": \"orders.order_id\",\n          \"transformation\": \"COUNT(DISTINCT order_id)\"\n        },\n        {\n          \"name\": \"total_quantity\",\n          \"source\": \"order_items.quantity\",\n          \"transformation\": \"SUM(quantity)\"\n        },\n        {\n          \"name\": \"total_spent\",\n          \"source\": \"order_items.quantity, products.price\",\n          \"transformation\": \"SUM(quantity * price)\"\n        },\n        {\n          \"name\": \"last_order_date\",\n          \"source\": \"orders.order_date\",\n          \"transformation\": \"MAX(order_date)\"\n        }\n      ]\n    },\n    \"operation_logic\": {\n      \"output_fields\": [\n        {\n          \"source_table\": \"customers\",\n          \"source_fields\": [\"customer_id\", \"name\", \"country\"],\n          \"logical_operators\": {\n            \"filters\": [\"c.country = 'USA'\"]\n          }\n        },\n        {\n          \"source_table\": \"orders\",\n          \"source_fields\": [\"customer_id\", \"order_id\", \"order_date\"],\n          \"logical_operators\": {\n            \"joins\": [\"c.customer_id = o.customer_id\"]\n          }\n        },\n        {\n          \"source_table\": \"order_items\",\n          \"source_fields\": [\"order_id\", \"quantity\"],\n          \"logical_operators\": {\n            \"joins\": [\"o.order_id = oi.order_id\"]\n          }\n        },\n        {\n          \"source_table\": \"products\",\n          \"source_fields\": [\"product_id\", \"price\"],\n          \"logical_operators\": {\n            \"joins\": [\"oi.product_id = p.product_id\"]\n          }\n        }\n      ]\n    }\n  }\n}\n### Explanation:\n\n1. **Structure**: This section outlines the SQL query operation, including the target table, the `SELECT` fields, the source `FROM` tables, `JOINs`, `WHERE` condition, and `GROUP BY` fields.\n2. **Field Mapping**: It explains how each output field in the target table (`customer_order_summary`) is derived from the source tables, including the transformation applied to create that field.\n3. **Operation Logic**: This section captures the logical operations affecting each source table, including filters and join conditions.\n\nThis format provides a complete view of the data lineage from the source tables through to the resulting target table."
"Here is the complete OpenLineage event JSON representing the end-to-end data lineage for the provided SQL query:\n\n{\n  \"eventType\": \"START\",\n  \"eventTime\": \"<ISO_TIMESTAMP>\",\n  \"run\": {\n    \"runId\": \"<UUID>\",\n    \"facets\": {\n      \"parent\": {\n        \"job\": {\n          \"name\": \"<PARENT_JOB_NAME>\",\n          \"namespace\": \"<PARENT_NAMESPACE>\"\n        },\n        \"run\": {\n          \"runId\": \"<PARENT_RUN_ID>\"\n        }\n      }\n    }\n  },\n  \"job\": {\n    \"facets\": {\n      \"sql\": {\n        \"_producer\": \"<PRODUCER_URL>\",\n        \"_schemaURL\": \"<SCHEMA_URL>\",\n        \"query\": \"CREATE TABLE customer_order_summary AS SELECT c.customer_id, c.name AS customer_name, c.country, COUNT(DISTINCT o.order_id) AS total_orders, SUM(oi.quantity) AS total_quantity, SUM(oi.quantity * p.price) AS total_spent, MAX(o.order_date) AS last_order_date FROM customers c JOIN orders o ON c.customer_id = o.customer_id JOIN order_items oi ON o.order_id = oi.order_id JOIN products p ON oi.product_id = p.product_id WHERE c.country = 'USA' GROUP BY c.customer_id, c.name, c.country\"\n      },\n      \"jobType\": {\n        \"processingType\": \"<BATCH_OR_STREAM>\",\n        \"integration\": \"<ENGINE_NAME>\",\n        \"jobType\": \"<QUERY_TYPE>\",\n        \"_producer\": \"<PRODUCER_URL>\",\n        \"_schemaURL\": \"<SCHEMA_URL>\"\n      }\n    }\n  },\n  \"inputs\": [\n    {\n      \"namespace\": \"<INPUT_NAMESPACE>\",\n      \"name\": \"customers\",\n      \"facets\": {\n        \"schema\": {\n          \"_producer\": \"<PRODUCER_URL>\",\n          \"_schemaURL\": \"<SCHEMA_URL>\",\n          \"fields\": [\n            {\n              \"name\": \"customer_id\",\n              \"type\": \"<FIELD_TYPE>\",\n              \"description\": \"<FIELD_DESCRIPTION>\"\n            },\n            {\n              \"name\": \"name\",\n              \"type\": \"<FIELD_TYPE>\",\n              \"description\": \"<FIELD_DESCRIPTION>\"\n            },\n            {\n              \"name\": \"country\",\n              \"type\": \"<FIELD_TYPE>\",\n              \"description\": \"<FIELD_DESCRIPTION>\"\n            }\n          ]\n        }\n      }\n    },\n    {\n      \"namespace\": \"<INPUT_NAMESPACE>\",\n      \"name\": \"orders\",\n      \"facets\": {\n        \"schema\": {\n          \"_producer\": \"<PRODUCER_URL>\",\n          \"_schemaURL\": \"<SCHEMA_URL>\",\n          \"fields\": [\n            {\n              \"name\": \"order_id\",\n              \"type\": \"<FIELD_TYPE>\",\n              \"description\": \"<FIELD_DESCRIPTION>\"\n            },\n            {\n              \"name\": \"customer_id\",\n              \"type\": \"<FIELD_TYPE>\",\n              \"description\": \"<FIELD_DESCRIPTION>\"\n            },\n            {\n              \"name\": \"order_date\",\n              \"type\": \"<FIELD_TYPE>\",\n              \"description\": \"<FIELD_DESCRIPTION>\"\n            }\n          ]\n        }\n      }\n    },\n    {\n      \"namespace\": \"<INPUT_NAMESPACE>\",\n      \"name\": \"order_items\",\n      \"facets\": {\n        \"schema\": {\n          \"_producer\": \"<PRODUCER_URL>\",\n          \"_schemaURL\": \"<SCHEMA_URL>\",\n          \"fields\": [\n            {\n              \"name\": \"quantity\",\n              \"type\": \"<FIELD_TYPE>\",\n              \"description\": \"<FIELD_DESCRIPTION>\"\n            },\n            {\n              \"name\": \"order_id\",\n              \"type\": \"<FIELD_TYPE>\",\n              \"description\": \"<FIELD_DESCRIPTION>\"\n            },\n            {\n              \"name\": \"product_id\",\n              \"type\": \"<FIELD_TYPE>\",\n              \"description\": \"<FIELD_DESCRIPTION>\"\n            }\n          ]\n        }\n      }\n    },\n    {\n      \"namespace\": \"<INPUT_NAMESPACE>\",\n      \"name\": \"products\",\n      \"facets\": {\n        \"schema\": {\n          \"_producer\": \"<PRODUCER_URL>\",\n          \"_schemaURL\": \"<SCHEMA_URL>\",\n          \"fields\": [\n            {\n              \"name\": \"price\",\n              \"type\": \"<FIELD_TYPE>\",\n              \"description\": \"<FIELD_DESCRIPTION>\"\n            },\n            {\n              \"name\": \"product_id\",\n              \"type\": \"<FIELD_TYPE>\",\n              \"description\": \"<FIELD_DESCRIPTION>\"\n            }\n          ]\n        }\n      }\n    }\n  ],\n  \"outputs\": [\n    {\n      \"namespace\": \"<OUTPUT_NAMESPACE>\",\n      \"name\": \"customer_order_summary\",\n      \"facets\": {\n        \"columnLineage\": {\n          \"_producer\": \"<PRODUCER_URL>\",\n          \"_schemaURL\": \"<SCHEMA_URL>\",\n          \"fields\": {\n            \"customer_id\": {\n              \"inputFields\": [\n                {\n                  \"namespace\": \"<INPUT_NAMESPACE>\",\n                  \"name\": \"customers\",\n                  \"field\": \"customer_id\",\n                  \"transformations\": [\n                    {\n                      \"type\": \"COPY\",\n                      \"subtype\": \"\",\n                      \"description\": \"Direct copy\",\n                      \"masking\": false\n                    }\n                  ]\n                }\n              ]\n            },\n            \"customer_name\": {\n              \"inputFields\": [\n                {\n                  \"namespace\": \"<INPUT_NAMESPACE>\",\n                  \"name\": \"customers\",\n                  \"field\": \"name\",\n                  \"transformations\": [\n                    {\n                      \"type\": \"COPY\",\n                      \"subtype\": \"ALIAS\",\n                      \"description\": \"Direct copy, aliased as customer_name\",\n                      \"masking\": false\n                    }\n                  ]\n                }\n              ]\n            },\n            \"country\": {\n              \"inputFields\": [\n                {\n                  \"namespace\": \"<INPUT_NAMESPACE>\",\n                  \"name\": \"customers\",\n                  \"field\": \"country\",\n                  \"transformations\": [\n                    {\n                      \"type\": \"COPY\",\n                      \"subtype\": \"\",\n                      \"description\": \"Direct copy\",\n                      \"masking\": false\n                    }\n                  ]\n                }\n              ]\n            },\n            \"total_orders\": {\n              \"inputFields\": [\n                {\n                  \"namespace\": \"<INPUT_NAMESPACE>\",\n                  \"name\": \"orders\",\n                  \"field\": \"order_id\",\n                  \"transformations\": [\n                    {\n                      \"type\": \"AGGREGATE\",\n                      \"subtype\": \"COUNT_DISTINCT\",\n                      \"description\": \"COUNT(DISTINCT order_id) to count unique orders for each customer\",\n                      \"masking\": false\n                    }\n                  ]\n                }\n              ]\n            },\n            \"total_quantity\": {\n              \"inputFields\": [\n                {\n                  \"namespace\": \"<INPUT_NAMESPACE>\",\n                  \"name\": \"order_items\",\n                  \"field\": \"quantity\",\n                  \"transformations\": [\n                    {\n                      \"type\": \"AGGREGATE\",\n                      \"subtype\": \"SUM\",\n                      \"description\": \"SUM(quantity) to compute total quantity of items purchased\",\n                      \"masking\": false\n                    }\n                  ]\n                }\n              ]\n            },\n            \"total_spent\": {\n              \"inputFields\": [\n                {\n                  \"namespace\": \"<INPUT_NAMESPACE>\",\n                  \"name\": \"order_items\",\n                  \"field\": \"quantity\",\n                  \"transformations\": [\n                    {\n                      \"type\": \"AGGREGATE\",\n                      \"subtype\": \"SUM\",\n                      \"description\": \"SUM(quantity * price) to compute total money spent by each customer\",\n                      \"masking\": false\n                    }\n                  ]\n                },\n                {\n                  \"namespace\": \"<INPUT_NAMESPACE>\",\n                  \"name\": \"products\",\n                  \"field\": \"price\",\n                  \"transformations\": [\n                    {\n                      \"type\": \"AGGREGATE\",\n                      \"subtype\": \"SUM\",\n                      \"description\": \"SUM(quantity * price)\",\n                      \"masking\": false\n                    }\n                  ]\n                }\n              ]\n            },\n            \"last_order_date\": {\n              \"inputFields\": [\n                {\n                  \"namespace\": \"<INPUT_NAMESPACE>\",\n                  \"name\": \"orders\",\n                  \"field\": \"order_date\",\n                  \"transformations\": [\n                    {\n                      \"type\": \"AGGREGATE\",\n                      \"subtype\": \"MAX\",\n                      \"description\": \"MAX(order_date) to find the most recent order date\",\n                      \"masking\": false\n                    }\n                  ]\n                }\n              ]\n            }\n          }\n        }\n      }\n    }\n  ]\n}\n### Notes\n- Replace all placeholder values like `<ISO_TIMESTAMP>`, `<UUID>`, `<PARENT_JOB_NAME>`, etc., with actual values relevant to your implementation.\n- Ensure that field types and descriptions are filled in based on your schema."
{"eventType":"START","eventTime":"<ISO_TIMESTAMP>","run":{"runId":"<UUID>","facets":{"parent":{"job":{"name":"<PARENT_JOB_NAME>","namespace":"<PARENT_NAMESPACE>"},"run":{"runId":"<PARENT_RUN_ID>"}}}},"job":{"facets":{"sql":{"_producer":"<PRODUCER_URL>","_schemaURL":"<SCHEMA_URL>","query":"CREATE TABLE customer_order_summary AS SELECT c.customer_id, c.name AS customer_name, c.country, COUNT(DISTINCT o.order_id) AS total_orders, SUM(oi.quantity) AS total_quantity, SUM(oi.quantity * p.price) AS total_spent, MAX(o.order_date) AS last_order_date FROM customers c JOIN orders o ON c.customer_id = o.customer_id JOIN order_items oi ON o.order_id = oi.order_id JOIN products p ON oi.product_id = p.product_id WHERE c.country = 'USA' GROUP BY c.customer_id, c.name, c.country"},"jobType":{"processingType":"<BATCH_OR_STREAM>","integration":"<ENGINE_NAME>","jobType":"CREATE TABLE","_producer":"<PRODUCER_URL>","_schemaURL":"<SCHEMA_URL>"}}},"inputs":[{"namespace":"<INPUT_NAMESPACE>","name":"customers","facets":{"schema":{"_producer":"<PRODUCER_URL>","_schemaURL":"<SCHEMA_URL>","fields":[{"name":"customer_id","type":"integer","description":"Customer's unique identifier."},{"name":"name","type":"string","description":"Customer's name."},{"name":"country","type":"string","description":"Customer's country."}]}}},{"namespace":"<INPUT_NAMESPACE>","name":"orders","facets":{"schema":{"_producer":"<PRODUCER_URL>","_schemaURL":"<SCHEMA_URL>","fields":[{"name":"order_id","type":"integer","description":"Order's unique identifier."},{"name":"customer_id","type":"integer","description":"ID of the customer who made the order."},{"name":"order_date","type":"date","description":"Date of the order."}]}}},{"namespace":"<INPUT_NAMESPACE>","name":"order_items","facets":{"schema":{"_producer":"<PRODUCER_URL>","_schemaURL":"<SCHEMA_URL>","fields":[{"name":"order_id","type":"integer","description":"ID of the order."},{"name":"quantity","type":"integer","description":"Quantity of items ordered."},{"name":"product_id","type":"integer","description":"ID of the product."}]}}},{"namespace":"<INPUT_NAMESPACE>","name":"products","facets":{"schema":{"_producer":"<PRODUCER_URL>","_schemaURL":"<SCHEMA_URL>","fields":[{"name":"product_id","type":"integer","description":"Product's unique identifier."},{"name":"price","type":"decimal","description":"Product price."}]}}}],"outputs":[{"namespace":"<OUTPUT_NAMESPACE>","name":"customer_order_summary","facets":{"columnLineage":{"_producer":"<PRODUCER_URL>","_schemaURL":"<SCHEMA_URL>","fields":{"customer_id":{"inputFields":[{"namespace":"<INPUT_NAMESPACE>","name":"customers","field":"customer_id","transformations":[{"type":"Reference","subtype":"Direct","description":"Direct reference from customers table."}]}]},"customer_name":{"inputFields":[{"namespace":"<INPUT_NAMESPACE>","name":"customers","field":"name","transformations":[{"type":"Reference","subtype":"Direct","description":"Direct reference from customers table, aliased as customer_name."}]}]},"country":{"inputFields":[{"namespace":"<INPUT_NAMESPACE>","name":"customers","field":"country","transformations":[{"type":"Reference","subtype":"Direct","description":"Direct reference from customers table."}]}]},"total_orders":{"inputFields":[{"namespace":"<INPUT_NAMESPACE>","name":"orders","field":"order_id","transformations":[{"type":"Aggregation","subtype":"Count","description":"Count of distinct orders."}]}]},"total_quantity":{"inputFields":[{"namespace":"<INPUT_NAMESPACE>","name":"order_items","field":"quantity","transformations":[{"type":"Aggregation","subtype":"Sum","description":"Total quantity of items ordered."}]}]},"total_spent":{"inputFields":[{"namespace":"<INPUT_NAMESPACE>","name":"order_items","field":"quantity","transformations":[{"type":"Aggregation","subtype":"Sum","description":"Total money spent calculated as quantity times price."}]},{"namespace":"<INPUT_NAMESPACE>","name":"products","field":"price","transformations":[{"type":"Reference","subtype":"Direct","description":"Direct reference from products table."}]}]},"last_order_date":{"inputFields":[{"namespace":"<INPUT_NAMESPACE>","name":"orders","field":"order_date","transformations":[{"type":"Aggregation","subtype":"Max","description":"Date of the last order placed."}]}]}}}}}]}
{"eventType":"START","eventTime":"2023-10-05T12:00:00Z","run":{"runId":"ab12cd34-5678-ef90-gh12-3456ijkl7890","facets":{"parent":{"job":{"name":"Parent_Job_Name","namespace":"Parent_Namespace"},"run":{"runId":"Parent_Run_ID"}}}},"job":{"facets":{"sql":{"_producer":"https://example.com/producer","_schemaURL":"https://example.com/schema/sql","query":"CREATE TABLE customer_order_summary AS SELECT c.customer_id, c.name AS customer_name, c.country, COUNT(DISTINCT o.order_id) AS total_orders, SUM(oi.quantity) AS total_quantity, SUM(oi.quantity * p.price) AS total_spent, MAX(o.order_date) AS last_order_date FROM customers c JOIN orders o ON c.customer_id = o.customer_id JOIN order_items oi ON o.order_id = oi.order_id JOIN products p ON oi.product_id = p.product_id WHERE c.country = 'USA' GROUP BY c.customer_id, c.name, c.country;"},"jobType":{"processingType":"BATCH","integration":"SQL_ENGINE","jobType":"CREATE_TABLE_AS_SELECT","_producer":"https://example.com/producer","_schemaURL":"https://example.com/schema/jobType"}}},"inputs":[{"namespace":"example_namespace","name":"customers","facets":{"schema":{"_producer":"https://example.com/producer","_schemaURL":"https://example.com/schema/schema","fields":[{"name":"customer_id","type":"INTEGER","description":"Customer ID"},{"name":"name","type":"STRING","description":"Name of the customer"},{"name":"country","type":"STRING","description":"Country of the customer"}]}}},{"namespace":"example_namespace","name":"orders","facets":{"schema":{"_producer":"https://example.com/producer","_schemaURL":"https://example.com/schema/schema","fields":[{"name":"customer_id","type":"INTEGER","description":"Customer ID"},{"name":"order_id","type":"INTEGER","description":"Order ID"},{"name":"order_date","type":"DATE","description":"Order date"}]}}},{"namespace":"example_namespace","name":"order_items","facets":{"schema":{"_producer":"https://example.com/producer","_schemaURL":"https://example.com/schema/schema","fields":[{"name":"order_id","type":"INTEGER","description":"Order ID"},{"name":"quantity","type":"INTEGER","description":"Quantity of items"},{"name":"product_id","type":"INTEGER","description":"Product ID"}]}}},{"namespace":"example_namespace","name":"products","facets":{"schema":{"_producer":"https://example.com/producer","_schemaURL":"https://example.com/schema/schema","fields":[{"name":"product_id","type":"INTEGER","description":"Product ID"},{"name":"price","type":"DECIMAL","description":"Product price"}]}}}],"outputs":[{"namespace":"example_namespace","name":"customer_order_summary","facets":{"columnLineage":{"_producer":"https://example.com/producer","_schemaURL":"https://example.com/schema/columnLineage","fields":{"customer_id":{"inputFields":[{"namespace":"example_namespace","name":"customers","field":"customer_id","transformations":[{"type":"Direct","subtype":"","description":"None","masking":false}]}]},"customer_name":{"inputFields":[{"namespace":"example_namespace","name":"customers","field":"name","transformations":[{"type":"Alias","subtype":"Rename","description":"Alias to customer_name","masking":false}]}]},"country":{"inputFields":[{"namespace":"example_namespace","name":"customers","field":"country","transformations":[{"type":"Direct","subtype":"","description":"None","masking":false}]}]},"total_orders":{"inputFields":[{"namespace":"example_namespace","name":"orders","field":"order_id","transformations":[{"type":"Aggregate","subtype":"Count Distinct","description":"COUNT(DISTINCT order_id)","masking":false}]}]},"total_quantity":{"inputFields":[{"namespace":"example_namespace","name":"order_items","field":"quantity","transformations":[{"type":"Aggregate","subtype":"Sum","description":"SUM(quantity)","masking":false}]}]},"total_spent":{"inputFields":[{"namespace":"example_namespace","name":"order_items","field":"quantity","transformations":[{"type":"Arithmetic","subtype":"Multiply","description":"SUM(quantity * price)","masking":false}]},{"namespace":"example_namespace","name":"products","field":"price","transformations":[{"type":"Arithmetic","subtype":"Multiply","description":"SUM(quantity * price)","masking":false}]}]},"last_order_date":{"inputFields":[{"namespace":"example_namespace","name":"orders","field":"order_date","transformations":[{"type":"Aggregate","subtype":"Max","description":"MAX(order_date)","masking":false}]}]}}}}}]}
{"lineage":{"structure":{"operation":"CREATE_TABLE","output_table":"customer_order_summary","select":{"columns":[{"original":"c.customer_id","alias":null},{"original":"c.name","alias":"customer_name"},{"original":"c.country","alias":null},{"original":"COUNT(DISTINCT o.order_id)","alias":"total_orders"},{"original":"SUM(oi.quantity)","alias":"total_quantity"},{"original":"SUM(oi.quantity * p.price)","alias":"total_spent"},{"original":"MAX(o.order_date)","alias":"last_order_date"}]},"from":{"tables":[{"name":"customers","alias":"c"},{"name":"orders","alias":"o","join_type":"JOIN","on":{"condition":"c.customer_id = o.customer_id"}},{"name":"order_items","alias":"oi","join_type":"JOIN","on":{"condition":"o.order_id = oi.order_id"}},{"name":"products","alias":"p","join_type":"JOIN","on":{"condition":"oi.product_id = p.product_id"}}]},"where":{"condition":"c.country = 'USA'"},"group_by":[{"column":"c.customer_id"},{"column":"c.name"},{"column":"c.country"}]},"field_mapping":{"output_fields":[{"name":"customer_id","source":"customers.customer_id","transformation":"Direct reference"},{"name":"customer_name","source":"customers.name","transformation":"Direct reference with alias"},{"name":"country","source":"customers.country","transformation":"Direct reference"},{"name":"total_orders","source":"orders.order_id","transformation":"COUNT(DISTINCT order_id) aggregated count of unique orders"},{"name":"total_quantity","source":"order_items.quantity","transformation":"SUM(quantity) aggregated sum of quantities"},{"name":"total_spent","source":"order_items.quantity, products.price","transformation":"SUM(quantity * price) aggregated sum of quantities multiplied by product price"},{"name":"last_order_date","source":"orders.order_date","transformation":"MAX(order_date) aggregated maximum date"}]},"operation_logic":{"filtering_conditions":[{"field":"c.country","condition":"c.country = 'USA'"}],"join_conditions":[{"table":"customers","field":"c.customer_id","condition":"c.customer_id = o.customer_id"},{"table":"orders","field":"o.order_id","condition":"o.order_id = oi.order_id"},{"table":"order_items","field":"oi.product_id","condition":"oi.product_id = p.product_id"}],"grouping_logic":[{"field":"c.customer_id"},{"field":"c.name"},{"field":"c.country"}]}}}
{"eventType":"START","eventTime":"<ISO_TIMESTAMP>","run":{"runId":"<UUID>","facets":{"parent":{"job":{"name":"<PARENT_JOB_NAME>","namespace":"<PARENT_NAMESPACE>"},"run":{"runId":"<PARENT_RUN_ID>"}}}},"job":{"facets":{"sql":{"_producer":"<PRODUCER_URL>","_schemaURL":"<SCHEMA_URL>","query":"CREATE TABLE customer_order_summary AS SELECT c.customer_id, c.name AS customer_name, c.country, COUNT(DISTINCT o.order_id) AS total_orders, SUM(oi.quantity) AS total_quantity, SUM(oi.quantity * p.price) AS total_spent, MAX(o.order_date) AS last_order_date FROM customers c JOIN orders o ON c.customer_id = o.customer_id JOIN order_items oi ON o.order_id = oi.order_id JOIN products p ON oi.product_id = p.product_id WHERE c.country = 'USA' GROUP BY c.customer_id, c.name, c.country"},"jobType":{"processingType":"BATCH","integration":"<ENGINE_NAME>","jobType":"CREATE TABLE","_producer":"<PRODUCER_URL>","_schemaURL":"<SCHEMA_URL>"}}},"inputs":[{"namespace":"<INPUT_NAMESPACE>","name":"customers","facets":{"schema":{"_producer":"<PRODUCER_URL>","_schemaURL":"<SCHEMA_URL>","fields":[{"name":"customer_id","type":"INTEGER","description":"Unique identifier for each customer"},{"name":"name","type":"STRING","description":"Customer's name"},{"name":"country","type":"STRING","description":"Customer's country"}]}}},{"namespace":"<INPUT_NAMESPACE>","name":"orders","facets":{"schema":{"_producer":"<PRODUCER_URL>","_schemaURL":"<SCHEMA_URL>","fields":[{"name":"customer_id","type":"INTEGER","description":"Identifier for the customer who placed the order"},{"name":"order_id","type":"INTEGER","description":"Unique identifier for each order"},{"name":"order_date","type":"DATE","description":"Date when the order was placed"}]}}},{"namespace":"<INPUT_NAMESPACE>","name":"order_items","facets":{"schema":{"_producer":"<PRODUCER_URL>","_schemaURL":"<SCHEMA_URL>","fields":[{"name":"order_id","type":"INTEGER","description":"Identifier for the order"},{"name":"product_id","type":"INTEGER","description":"Identifier for the product ordered"},{"name":"quantity","type":"INTEGER","description":"Quantity of the product ordered"}]}}},{"namespace":"<INPUT_NAMESPACE>","name":"products","facets":{"schema":{"_producer":"<PRODUCER_URL>","_schemaURL":"<SCHEMA_URL>","fields":[{"name":"product_id","type":"INTEGER","description":"Unique identifier for each product"},{"name":"price","type":"FLOAT","description":"Price of the product"}]}}}],"outputs":[{"namespace":"<OUTPUT_NAMESPACE>","name":"customer_order_summary","facets":{"columnLineage":{"_producer":"<PRODUCER_URL>","_schemaURL":"<SCHEMA_URL>","fields":{"customer_id":{"inputFields":[{"namespace":"<INPUT_NAMESPACE>","name":"customers","field":"customer_id","transformations":[{"type":"DIRECT","subtype":"COPY","description":"Direct reference from customers.customer_id","masking":"NONE"}]}]},"customer_name":{"inputFields":[{"namespace":"<INPUT_NAMESPACE>","name":"customers","field":"name","transformations":[{"type":"DIRECT","subtype":"COPY","description":"Direct reference from customers.name, aliased as customer_name","masking":"NONE"}]}]},"country":{"inputFields":[{"namespace":"<INPUT_NAMESPACE>","name":"customers","field":"country","transformations":[{"type":"DIRECT","subtype":"COPY","description":"Direct reference from customers.country","masking":"NONE"}]}]},"total_orders":{"inputFields":[{"namespace":"<INPUT_NAMESPACE>","name":"orders","field":"order_id","transformations":[{"type":"AGGREGATION","subtype":"COUNT_DISTINCT","description":"Counts distinct orders per customer","masking":"NONE"}]}]},"total_quantity":{"inputFields":[{"namespace":"<INPUT_NAMESPACE>","name":"order_items","field":"quantity","transformations":[{"type":"AGGREGATION","subtype":"SUM","description":"Sums the quantities of ordered items","masking":"NONE"}]}]},"total_spent":{"inputFields":[{"namespace":"<INPUT_NAMESPACE>","name":"order_items","field":"quantity","transformations":[{"type":"AGGREGATION","subtype":"SUM_MULTIPLY","description":"Calculates total spent by multiplying quantity with price","masking":"NONE"}]},{"namespace":"<INPUT_NAMESPACE>","name":"products","field":"price","transformations":[{"type":"AGGREGATION","subtype":"SUM_MULTIPLY","description":"Calculates total spent by multiplying quantity with price","masking":"NONE"}]}]},"last_order_date":{"inputFields":[{"namespace":"<INPUT_NAMESPACE>","name":"orders","field":"order_date","transformations":[{"type":"AGGREGATION","subtype":"MAX","description":"Retrieves the most recent order date","masking":"NONE"}]}]}}}}}]}
{"eventType":"START","eventTime":"<ISO_TIMESTAMP>","run":{"runId":"<UUID>","facets":{"parent":{"job":{"name":"<PARENT_JOB_NAME>","namespace":"<PARENT_NAMESPACE>"},"run":{"runId":"<PARENT_RUN_ID>"}}}},"job":{"facets":{"sql":{"_producer":"<PRODUCER_URL>","_schemaURL":"<SCHEMA_URL>","query":"CREATE TABLE customer_order_summary AS SELECT c.customer_id, c.name AS customer_name, c.country, COUNT(DISTINCT o.order_id) AS total_orders, SUM(oi.quantity) AS total_quantity, SUM(oi.quantity * p.price) AS total_spent, MAX(o.order_date) AS last_order_date FROM customers c JOIN orders o ON c.customer_id = o.customer_id JOIN order_items oi ON o.order_id = oi.order_id JOIN products p ON oi.product_id = p.product_id WHERE c.country = 'USA' GROUP BY c.customer_id, c.name, c.country"},"jobType":{"processingType":"BATCH","integration":"<ENGINE_NAME>","jobType":"<QUERY_TYPE>","_producer":"<PRODUCER_URL>","_schemaURL":"<SCHEMA_URL>"}}},"inputs":[{"namespace":"<INPUT_NAMESPACE>","name":"customers","facets":{"schema":{"_producer":"<PRODUCER_URL>","_schemaURL":"<SCHEMA_URL>","fields":[{"name":"customer_id","type":"INTEGER","description":"Unique identifier for customers"},{"name":"name","type":"VARCHAR","description":"Name of the customer"},{"name":"country","type":"VARCHAR","description":"Country of the customer"}]}}},{"namespace":"<INPUT_NAMESPACE>","name":"orders","facets":{"schema":{"_producer":"<PRODUCER_URL>","_schemaURL":"<SCHEMA_URL>","fields":[{"name":"order_id","type":"INTEGER","description":"Unique identifier for orders"},{"name":"order_date","type":"DATE","description":"Date of the order"}]}}},{"namespace":"<INPUT_NAMESPACE>","name":"order_items","facets":{"schema":{"_producer":"<PRODUCER_URL>","_schemaURL":"<SCHEMA_URL>","fields":[{"name":"quantity","type":"INTEGER","description":"Quantity of items in the order"}]}}},{"namespace":"<INPUT_NAMESPACE>","name":"products","facets":{"schema":{"_producer":"<PRODUCER_URL>","_schemaURL":"<SCHEMA_URL>","fields":[{"name":"price","type":"DECIMAL","description":"Price of the product"},{"name":"product_id","type":"INTEGER","description":"Unique identifier for products"}]}}}],"outputs":[{"namespace":"<OUTPUT_NAMESPACE>","name":"customer_order_summary","facets":{"columnLineage":{"_producer":"<PRODUCER_URL>","_schemaURL":"<SCHEMA_URL>","fields":{"customer_id":{"inputFields":[{"namespace":"<INPUT_NAMESPACE>","name":"customers","field":"customer_id","transformations":[{"type":"COPY","subtype":"DIRECT","description":"Direct copy from the customers table","masking":"NONE"}]}]},"customer_name":{"inputFields":[{"namespace":"<INPUT_NAMESPACE>","name":"customers","field":"name","transformations":[{"type":"COPY","subtype":"ALIASING","description":"AS aliasing for direct copy from customers.name","masking":"NONE"}]}]},"country":{"inputFields":[{"namespace":"<INPUT_NAMESPACE>","name":"customers","field":"country","transformations":[{"type":"COPY","subtype":"DIRECT","description":"Direct copy from the customers table","masking":"NONE"}]}]},"total_orders":{"inputFields":[{"namespace":"<INPUT_NAMESPACE>","name":"orders","field":"order_id","transformations":[{"type":"AGGREGATION","subtype":"COUNT_DISTINCT","description":"COUNT(DISTINCT o.order_id)","masking":"NONE"}]}]},"total_quantity":{"inputFields":[{"namespace":"<INPUT_NAMESPACE>","name":"order_items","field":"quantity","transformations":[{"type":"AGGREGATION","subtype":"SUM","description":"SUM(oi.quantity)","masking":"NONE"}]}]},"total_spent":{"inputFields":[{"namespace":"<INPUT_NAMESPACE>","name":"order_items","field":"quantity","transformations":[{"type":"AGGREGATION","subtype":"SUM","description":"SUM(oi.quantity * p.price)","masking":"NONE"}]},{"namespace":"<INPUT_NAMESPACE>","name":"products","field":"price","transformations":[{"type":"AGGREGATION","subtype":"SUM","description":"SUM(oi.quantity * p.price)","masking":"NONE"}]}]},"last_order_date":{"inputFields":[{"namespace":"<INPUT_NAMESPACE>","name":"orders","field":"order_date","transformations":[{"type":"AGGREGATION","subtype":"MAX","description":"MAX(o.order_date)","masking":"NONE"}]}]}}}}}]}
